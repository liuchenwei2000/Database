

骞跺彂鎺у埗涓昏鏈変袱绉嶆柟寮忥細涔愯閿佸拰鎮茶閿併�


鎮茶閿侊紙Pessimistic Locking锛屽亣瀹氫細鍙戠敓鍐茬獊锛屽睆钄戒竴鍒囧彲鑳借繚鍙嶆暟鎹簱瀹屾暣鎬х殑鎿嶄綔銆傦級

瀹冨彲浠ラ樆姝竴涓簨鍔′互褰卞搷鍏朵粬浜嬪姟鐨勬柟寮忔潵淇敼鏁版嵁銆傚鏋滀竴涓簨鍔℃墽琛岀殑鎿嶄綔鍦ㄦ煇琛屾暟鎹笂搴旂敤浜嗛攣锛岄偅鍙湁褰撹繖涓簨鍔℃妸閿侀噴鏀撅紝鍏朵粬浜嬪姟鎵嶈兘鎵ц涓庤閿佸啿绐佺殑鎿嶄綔銆�

瀹炵幇鏈虹悊锛�
渚濋潬鏁版嵁搴撶殑閿佹満鍒跺疄鐜板姞閿侊紝濡�SELECT ... FOR UPDATE銆�

浼樼己鐐癸細
鎮茶閿佹墠鍘荤殑鏄�鍏堝姞閿佸啀璁块棶鈥濈殑淇濆畧绛栫暐锛屼负鏁版嵁澶勭悊鐨勫畨鍏ㄦ�鎻愪緵浜嗕繚璇併�浣嗗湪鏁堢巼鏂归潰锛屽鐞嗗姞閿佺殑鏈哄埗浼氳鏁版嵁搴撲骇鐢熼澶栫殑寮�攢锛岃繕鏈夊鍔犳閿佺殑鏈轰細銆傚彟澶栵紝鍦ㄥ彧璇诲瀷浜嬪姟澶勭悊涓敱浜庝笉浼氫骇鐢熷啿绐侊紝涔熸病鏈夊繀瑕佷娇鐢ㄩ攣锛岃繖鏍峰仛鍙細澧炲姞绯荤粺璐熻浇銆傛澶栵紝瀹冧細闄嶄綆骞跺彂鎬э紝涓�釜浜嬪姟閿佸畾鏌愯鏁版嵁锛屽叾浠栦簨鍔″彧鑳界瓑鍒拌浜嬪姟澶勭悊瀹屾墠鍙互澶勭悊閭ｈ鏁版嵁銆�

搴旂敤鍦烘櫙锛�
涓昏鐢ㄤ簬鏁版嵁浜夌敤婵�儓鐨勭幆澧冿紝浠ュ強鍙戠敓骞跺彂鍐茬獊鏃朵娇鐢ㄩ攣淇濇姢鏁版嵁鐨勬垚鏈浣庝簬鍥炴粴浜嬪姟鐨勬垚鏈殑鐜涓�


涔愯閿侊紙Optimistic Locking锛屽亣瀹氫笉浼氬彂鐢熷啿绐侊紝鍙湪鎻愪氦鏃舵鏌ユ槸鍚﹁繚鍙嶆暟鎹畬鏁存�銆傦級

骞跺彂鐨勫悇浜嬪姟鑳藉鍦ㄤ笉浜х敓閿侊紙鏁版嵁搴撻攣锛夌殑鎯呭喌涓嬭嚜鐢辫鍙栧苟澶勭悊鏁版嵁銆傚湪鎻愪氦鏁版嵁鏇存柊涔嬪墠锛屾瘡涓簨鍔￠兘浼氭鏌ュ湪璇ヤ簨鍔¤鍙栨暟鎹悗锛屾湁娌℃湁鍏朵粬浜嬪姟鍙堜慨鏀逛簡璇ユ暟鎹紝鏈夌殑璇濓紝鍒欒浜嬪姟浼氬洖婊氥�

瀹炵幇鏈虹悊锛�
1锛岃鍙栵細浜嬪姟灏嗘暟鎹鍏ワ紝璇ユ暟鎹湁涓�釜鍒楄褰曠増鏈彿鎴栨椂闂存埑銆�
2锛屾牎楠岋細浜嬪姟鎵ц瀹屾瘯鍑嗗鎻愪氦锛屾鏃朵細鏍￠獙鐗堟湰鍙锋垨鏃堕棿鎴筹紝浠ュ垽鏂暟鎹槸鍚﹀湪璇诲彇鍚庡張琚埆鐨勪簨鍔′慨鏀广�
3锛屽啓鍏ワ細鑻ラ�杩囨牎楠岋紝鍒欐洿鏂扮殑鏁版嵁鍐欏叆鏁版嵁搴擄紝鍚﹀垯浜嬪姟鍥炴粴銆�

浼樼己鐐癸細
涔愯閿佺殑瀹炵幇涓嶄緷璧栨暟鎹簱閿佹満鍒讹紝瀹屽叏鏄熀浜庣郴缁熺殑鏁版嵁瀛樺偍閫昏緫锛屽洜姝や笉浼氫骇鐢熶换浣曢攣鍜屾閿侊紝浣嗕篃鏃犳硶瑙ｅ喅鑴忚鐨勯棶棰樸�鍙﹀锛岃嫢澶栫郴缁熺洿鎺ヤ慨鏀规暟鎹紝鍒欎細缁曡繃杩欓亾鏍￠獙銆傚彲灏嗕箰瑙傞攣鏈哄埗鍦ㄦ暟鎹簱瀛樺偍杩囩▼涓疄鐜帮紝鍙澶栧紑鏀惧熀浜庡瓨鍌ㄨ繃绋嬬殑鏁版嵁鏇存柊锛岃�涓嶅厑璁哥洿鎺ユ搷浣滆〃銆�

搴旂敤鍦烘櫙锛�
澶氭暟鐢ㄤ簬鏁版嵁浜夌敤涓嶅ぇ鍐茬獊杈冨皯鐨勭幆澧冿紝鍋跺皵鐨勪簨鍔″洖婊氱殑鎴愭湰涔熶綆浜庤鍙栨暟鎹椂閿佸畾鏁版嵁鐨勬垚鏈紝鍥犳鍙幏寰楁洿楂樼殑鍚炲悙閲忋�
